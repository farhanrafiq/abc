<!-- Professional Header -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
    <div class="container-fluid px-4">
        <!-- Brand -->
        <a class="navbar-brand d-flex align-items-center" href="{{ url_for('web.index') }}">
            <div class="brand-logo">
                <img src="{{ url_for('static', filename='uploads/abc_logo.png') }}" alt="ABC Publishing Kashmir" 
                     style="height: 50px; width: auto;">
            </div>
        </a>

        <!-- Desktop Search Bar (centered) -->
        <div class="d-none d-lg-flex flex-grow-1 justify-content-center mx-4">
            <form class="search-form" method="GET" action="{{ url_for('web.search') }}" style="width: 100%; max-width: 500px;">
                <div class="input-group shadow-sm">
                    <input class="form-control border-0 py-2 px-3" type="search" name="q" 
                           placeholder="Search for books, authors, ISBN..." aria-label="Search" 
                           value="{{ request.args.get('q', '') }}" style="font-size: 0.95rem;">
                    <button class="btn btn-brand-orange px-4" type="submit">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </form>
        </div>

        <!-- Right Section -->
        <div class="d-flex align-items-center gap-3">
            <!-- Cart with professional styling -->
            <a href="{{ url_for('cart.view_cart') }}" class="cart-link position-relative">
                <i class="fas fa-shopping-cart" style="font-size: 1.1rem; color: #3B2A22;"></i>
                <span class="cart-count position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                    <span id="cart-count">{{ session.get('cart_count', 0) }}</span>
                </span>
            </a>

            <!-- User Account -->
            {% if current_user.is_authenticated %}
            <div class="dropdown">
                <button class="btn btn-outline-secondary dropdown-toggle" type="button" 
                        data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fas fa-user me-2"></i>{{ current_user.first_name or 'Account' }}
                </button>
                <ul class="dropdown-menu dropdown-menu-end">
                    <li><a class="dropdown-item" href="{{ url_for('web.account') }}">
                        <i class="fas fa-user me-2"></i>My Account
                    </a></li>
                    <li><a class="dropdown-item" href="{{ url_for('web.account') }}">
                        <i class="fas fa-box me-2"></i>My Orders
                    </a></li>
                    <li><hr class="dropdown-divider"></li>
                    {% if current_user.role in ['admin', 'staff'] %}
                    <li><a class="dropdown-item" href="{{ url_for('admin.dashboard') }}">
                        <i class="fas fa-cog me-2"></i>Admin Panel
                    </a></li>
                    <li><hr class="dropdown-divider"></li>
                    {% endif %}
                    <li><a class="dropdown-item" href="{{ url_for('auth.logout') }}">
                        <i class="fas fa-sign-out-alt me-2"></i>Logout
                    </a></li>
                </ul>
            </div>
            {% else %}
            <a href="{{ url_for('auth.login') }}" class="btn btn-brand-orange">
                <i class="fas fa-sign-in-alt me-2"></i>Login
            </a>
            {% endif %}

        </div>
    </div>

</nav>

<!-- Responsive Horizontal Navigation Bar - directly below header -->
<div class="desktop-header-nav bg-light border-bottom">
    <div class="container">
        <!-- Mobile Menu Toggle and Action Buttons (only on mobile) -->
        <div class="mobile-menu-toggle d-none d-flex justify-content-between align-items-center w-100">
            <button class="btn btn-outline-primary d-flex align-items-center flex-grow-1 me-2" onclick="toggleMobileMenu()">
                <i class="fas fa-bars me-2"></i>Menu
            </button>
            
            <button class="btn btn-outline-info d-flex align-items-center justify-content-center flex-grow-1 me-2" onclick="toggleMobileSearch()" title="Search Books">
                <i class="fas fa-search me-1"></i>Search
            </button>
            
            <a href="tel:+919876543210" 
               class="btn btn-outline-warning d-flex align-items-center justify-content-center flex-grow-1 me-2"
               title="Call us">
                <i class="fas fa-phone me-1"></i>Call
            </a>
            
            <a href="https://wa.me/919876543210?text=Hello%20ABC%20Publishing%20Kashmir" 
               class="btn btn-success d-flex align-items-center justify-content-center flex-grow-1"
               target="_blank"
               title="Contact us on WhatsApp">
                <i class="fab fa-whatsapp me-1"></i>Chat
            </a>
        </div>
        
        <!-- Mobile Search Bar (hidden by default, only on mobile) -->
        <div class="mobile-search-bar d-none" id="mobileSearchBar" style="display: none;">
            <div class="p-3 border-bottom">
                <form action="{{ url_for('web.search') }}" method="GET" class="d-flex">
                    <input type="text" 
                           name="q" 
                           class="form-control me-2" 
                           placeholder="Search books, authors, topics..."
                           required>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-search"></i>
                    </button>
                </form>
            </div>
        </div>
        
        <nav class="header-nav-horizontal py-3">
            <div class="header-nav-links">
                <a href="{{ url_for('web.index') }}" class="header-nav-link">
                    <i class="fas fa-home me-1"></i>Home
                </a>
                
                <div class="header-nav-dropdown">
                    <a href="{{ url_for('web.catalog') }}" class="header-nav-link dropdown-trigger">
                        <i class="fas fa-th-large me-1"></i>All Books
                        <i class="fas fa-chevron-down ms-1"></i>
                    </a>
                    <div class="mega-menu">
                        <div class="mega-menu-container">
                            <div class="mega-menu-content">
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">English</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='quran-studies') }}">Quran Studies</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='hadith') }}">Hadith Collections</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='fiqh') }}">Islamic Jurisprudence</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='seerah') }}">Biography of Prophet</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='islamic-history') }}">Islamic History</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='contemporary-issues') }}">Contemporary Issues</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='spirituality') }}">Spirituality & Sufism</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='comparative-religion') }}">Comparative Religion</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">اردو</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='quran-studies') }}">قرآنی علوم</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='hadith') }}">احادیث کے مجموعے</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='fiqh') }}">اسلامی فقہ</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='seerah') }}">سیرت النبی</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='dua-books') }}">دعاؤں کی کتابیں</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='akhlaq') }}">اخلاق و آداب</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='poetry') }}">اسلامی شاعری</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='children') }}">بچوں کی کتابیں</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">العربية</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='quran-studies') }}">علوم القرآن</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='hadith') }}">الأحاديث النبوية</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='fiqh') }}">الفقه الإسلامي</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='aqeedah') }}">العقيدة الإسلامية</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='arabic-grammar') }}">النحو والصرف</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='classical-texts') }}">النصوص الكلاسيكية</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='islamic-philosophy') }}">الفلسفة الإسلامية</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='quranic-commentary') }}">التفسير</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="header-nav-dropdown">
                    <a href="{{ url_for('web.catalog', category_slug='mushafs') }}" class="header-nav-link dropdown-trigger">
                        <i class="fas fa-book-quran me-1"></i>Mushafs
                        <i class="fas fa-chevron-down ms-1"></i>
                    </a>
                    <div class="mega-menu">
                        <div class="mega-menu-container">
                            <div class="mega-menu-content">
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">English</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='quran-translation') }}">English Translation</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='quran-transliteration') }}">Transliteration</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='pocket-quran') }}">Pocket Size Quran</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='large-print-quran') }}">Large Print Quran</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='color-coded-quran') }}">Color Coded Quran</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='quran-with-tafseer') }}">Quran with Commentary</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">اردو</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='quran-pak') }}">قرآن پاک</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='quran-urdu-translation') }}">اردو ترجمہ کے ساتھ</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='hafzi-quran') }}">حافظی قرآن</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='tajweed-quran') }}">تجوید کے ساتھ</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='15-lines-quran') }}">پندرہ لائن</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='13-lines-quran') }}">تیرہ لائن</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">العربية</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='mushaf-arabic') }}">المصحف الشريف</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='mushaf-madinah') }}">مصحف المدينة</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='mushaf-uthmani') }}">الرسم العثماني</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='mushaf-tajweed') }}">مصحف التجويد</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='mushaf-warsh') }}">رواية ورش</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='mushaf-hafs') }}">رواية حفص</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="header-nav-dropdown">
                    <a href="{{ url_for('web.catalog', category_slug='academics') }}" class="header-nav-link dropdown-trigger">
                        <i class="fas fa-graduation-cap me-1"></i>Academics
                        <i class="fas fa-chevron-down ms-1"></i>
                    </a>
                    <div class="mega-menu">
                        <div class="mega-menu-container">
                            <div class="mega-menu-content">
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">English</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='islamic-studies') }}">Islamic Studies</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='arabic-language') }}">Arabic Language</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='islamic-law') }}">Islamic Law</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='theology') }}">Islamic Theology</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='research-methodology') }}">Research Methodology</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='dissertation-guides') }}">Dissertation Guides</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='conference-proceedings') }}">Conference Proceedings</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='journal-publications') }}">Journal Publications</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">اردو</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='islamiyat') }}">اسلامیات</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='arabic-adab') }}">عربی ادب</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='urdu-adab') }}">اردو ادب</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='mantiq') }}">منطق</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='falsafa') }}">فلسفہ</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='tareekh') }}">تاریخ</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='tahqeeq') }}">تحقیقی مقالات</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='madrasa-books') }}">درسی کتب</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">العربية</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='usul-fiqh') }}">أصول الفقه</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='usul-hadith') }}">أصول الحديث</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='usul-tafseer') }}">أصول التفسير</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='logic') }}">المنطق</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='rhetoric') }}">البلاغة</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='prosody') }}">العروض</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='academic-research') }}">البحوث الأكاديمية</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='university-texts') }}">النصوص الجامعية</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="header-nav-dropdown">
                    <a href="{{ url_for('web.catalog', category_slug='quran-studies') }}" class="header-nav-link dropdown-trigger">
                        <i class="fas fa-book-open me-1"></i>Quran Studies
                        <i class="fas fa-chevron-down ms-1"></i>
                    </a>
                    <div class="mega-menu">
                        <div class="mega-menu-container">
                            <div class="mega-menu-content">
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">English</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='tafseer') }}">Quranic Commentary</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='quran-science') }}">Quran & Science</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='memorization') }}">Memorization Guides</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='recitation') }}">Recitation (Qiraat)</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='themes') }}">Thematic Studies</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">اردو</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='tafseer-urdu') }}">تفسیر قرآن</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='uloom-quran') }}">علوم القرآن</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='hifz') }}">حفظ قرآن</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='qirat') }}">قراءت</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='nazm-quran') }}">نظم قرآن</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">العربية</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='tafseer-arabic') }}">التفسير</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='quranic-sciences') }}">علوم القرآن</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='qiraat') }}">القراءات</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='nasikh-mansukh') }}">الناسخ والمنسوخ</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='asbab-nuzul') }}">أسباب النزول</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="header-nav-dropdown">
                    <a href="{{ url_for('web.catalog', category_slug='hadith') }}" class="header-nav-link dropdown-trigger">
                        <i class="fas fa-scroll me-1"></i>Hadith
                        <i class="fas fa-chevron-down ms-1"></i>
                    </a>
                    <div class="mega-menu">
                        <div class="mega-menu-container">
                            <div class="mega-menu-content">
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">English</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='sahih-bukhari') }}">Sahih Bukhari</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='sahih-muslim') }}">Sahih Muslim</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='sunan-abu-dawood') }}">Sunan Abu Dawood</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='jami-tirmidhi') }}">Jami Tirmidhi</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='sunan-nasai') }}">Sunan Nasai</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='sunan-ibn-majah') }}">Sunan Ibn Majah</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='muwatta-malik') }}">Muwatta Malik</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='hadith-qudsi') }}">Hadith Qudsi</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">اردو</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='sahih-bukhari') }}">صحیح بخاری</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='sahih-muslim') }}">صحیح مسلم</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='sunan-abu-dawood') }}">سنن ابو داؤد</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='jami-tirmidhi') }}">جامع ترمذی</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='sunan-nasai') }}">سنن نسائی</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='sunan-ibn-majah') }}">سنن ابن ماجہ</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='mishkat-masabih') }}">مشکوٰۃ المصابیح</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='riyadh-saliheen') }}">ریاض الصالحین</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">العربية</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='sahih-bukhari') }}">صحيح البخاري</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='sahih-muslim') }}">صحيح مسلم</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='sunan-abu-dawood') }}">سنن أبي داود</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='jami-tirmidhi') }}">جامع الترمذي</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='sunan-nasai') }}">سنن النسائي</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='sunan-ibn-majah') }}">سنن ابن ماجه</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='musnad-ahmad') }}">مسند أحمد</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='hadith-collections') }}">مجاميع الحديث</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="header-nav-dropdown">
                    <a href="{{ url_for('web.catalog', category_slug='fiqh') }}" class="header-nav-link dropdown-trigger">
                        <i class="fas fa-balance-scale me-1"></i>Fiqh
                        <i class="fas fa-chevron-down ms-1"></i>
                    </a>
                    <div class="mega-menu">
                        <div class="mega-menu-container">
                            <div class="mega-menu-content">
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">English</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='hanafi-fiqh') }}">Hanafi Fiqh</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='shafii-fiqh') }}">Shafi'i Fiqh</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='maliki-fiqh') }}">Maliki Fiqh</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='hanbali-fiqh') }}">Hanbali Fiqh</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='comparative-fiqh') }}">Comparative Fiqh</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='family-law') }}">Family Law</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='commercial-law') }}">Commercial Law</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='inheritance-law') }}">Inheritance Law</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">اردو</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='hanafi-fiqh') }}">حنفی فقہ</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='shafii-fiqh') }}">شافعی فقہ</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='fatawa') }}">فتاویٰ</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='nikah-talaq') }}">نکاح و طلاق</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='muamalat') }}">معاملات</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='ibadat') }}">عبادات</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='hudood') }}">حدود</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='mirath') }}">میراث</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">العربية</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='hanafi-fiqh') }}">الفقه الحنفي</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='shafii-fiqh') }}">الفقه الشافعي</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='maliki-fiqh') }}">الفقه المالكي</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='hanbali-fiqh') }}">الفقه الحنبلي</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='usul-fiqh') }}">أصول الفقه</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='qawaid-fiqhiyya') }}">القواعد الفقهية</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='fatawa-arabic') }}">الفتاوى</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='fiqh-muqaran') }}">الفقه المقارن</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="header-nav-dropdown">
                    <a href="{{ url_for('web.catalog', category_slug='seerah') }}" class="header-nav-link dropdown-trigger">
                        <i class="fas fa-user me-1"></i>Seerah
                        <i class="fas fa-chevron-down ms-1"></i>
                    </a>
                    <div class="mega-menu">
                        <div class="mega-menu-container">
                            <div class="mega-menu-content">
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">English</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='prophet-biography') }}">Biography of Prophet</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='companions-biography') }}">Companions (Sahabah)</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='caliphs-biography') }}">Rightly Guided Caliphs</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='islamic-history') }}">Islamic History</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='battles-ghazawat') }}">Battles (Ghazawat)</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='prophetic-traditions') }}">Prophetic Traditions</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='makkah-madinah') }}">Makkah & Madinah</a>
                                        <a href="{{ url_for('web.catalog', language='english', category_slug='noble-character') }}">Noble Character</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">اردو</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='seerah-nabvi') }}">سیرت النبی</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='ashaab-kiram') }}">اصحاب کرام</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='khulafa-rashida') }}">خلفاء راشدہ</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='tareekh-islam') }}">تاریخ اسلام</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='ghazawat') }}">غزوات</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='akhlaq-nabvi') }}">اخلاق نبوی</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='shama-il') }}">شمائل</a>
                                        <a href="{{ url_for('web.catalog', language='urdu', category_slug='naat-hamd') }}">نعت و حمد</a>
                                    </div>
                                </div>
                                <div class="mega-menu-section">
                                    <h5 class="mega-menu-title">العربية</h5>
                                    <div class="mega-menu-links">
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='seerah-nabawiyya') }}">السيرة النبوية</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='sahabah') }}">الصحابة</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='khulafa-rashideen') }}">الخلفاء الراشدون</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='tarikh-islam') }}">تاريخ الإسلام</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='ghazawat-arabic') }}">الغزوات</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='shamail-muhammadiyya') }}">الشمائل المحمدية</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='akhlaq-nabawi') }}">الأخلاق النبوية</a>
                                        <a href="{{ url_for('web.catalog', language='arabic', category_slug='madaih-nabawiyya') }}">المدائح النبوية</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </div>
</div>


<!-- Professional Header Styles -->
<style>
.nav-link-custom {
    color: #3B2A22;
    text-decoration: none;
    font-weight: 500;
    font-size: 0.95rem;
    transition: color 0.2s ease;
}

.nav-link-custom:hover {
    color: #E86A17;
}

.cart-link {
    padding: 8px;
    border-radius: 8px;
    transition: background-color 0.2s ease;
}

.cart-link:hover {
    background-color: #f8f9fa;
}

.cart-count {
    font-size: 0.7rem;
    min-width: 18px;
    height: 18px;
}

/* Professional mobile cart styling */
@media (max-width: 768px) {
    .cart-link {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        padding: 10px 12px;
        border-radius: 6px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        transition: all 0.2s ease;
    }
    
    .cart-link:hover {
        background-color: #e9ecef;
        border-color: #3B2A22;
        transform: translateY(-1px);
        box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    }
    
    .cart-count {
        font-size: 0.6rem;
        min-width: 18px;
        height: 18px;
        line-height: 18px;
        font-weight: 700;
        top: -4px;
        right: -4px;
        background: linear-gradient(135deg, #dc3545, #c82333);
        border: 2px solid white;
        box-shadow: 0 1px 3px rgba(220, 53, 69, 0.3);
    }
}

.mobile-nav-link {
    display: block;
    padding: 12px 0;
    color: #3B2A22;
    text-decoration: none;
    border-bottom: 1px solid #e9ecef;
    font-weight: 500;
}

.mobile-nav-link:hover {
    color: #E86A17;
}

.mobile-nav-link:last-child {
    border-bottom: none;
}

/* Desktop Horizontal Navigation Below Header */
.desktop-header-nav {
    background: #f8f9fa;
    border-bottom: 1px solid #dee2e6;
    position: relative;
    z-index: 1000;
}

.header-nav-links {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    gap: 2rem;
}

.header-nav-link {
    color: #3B2A22;
    text-decoration: none;
    font-weight: 500;
    font-size: 0.95rem;
    padding: 8px 12px;
    border-radius: 6px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    position: relative;
}

.header-nav-link:hover {
    color: #E86A17;
    background: rgba(232, 106, 23, 0.1);
    text-decoration: none;
}

.header-nav-link i {
    color: #E86A17;
}

/* Mega Menu System */
.header-nav-dropdown {
    position: relative;
    display: inline-block;
}

.dropdown-trigger .fa-chevron-down {
    font-size: 0.75rem;
    transition: transform 0.3s ease;
}

.header-nav-dropdown:hover .dropdown-trigger .fa-chevron-down {
    transform: rotate(180deg);
}

.mega-menu {
    position: fixed;
    top: 150px;
    left: 0;
    right: 0;
    background: white;
    border-top: 3px solid #E86A17;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 999;
}

.header-nav-dropdown:hover .mega-menu {
    opacity: 1;
    visibility: visible;
    margin-top: 0;
}

.mega-menu-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.mega-menu-content {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 40px;
    padding: 40px 0;
    overflow: hidden;
}

.mega-menu-section {
    min-height: 200px;
    overflow: hidden;
}

.mega-menu-title {
    color: #3B2A22;
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #E86A17;
    position: relative;
}

.mega-menu-title::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 30px;
    height: 2px;
    background: #3B2A22;
}

.mega-menu-links {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.mega-menu-links a {
    color: #666;
    text-decoration: none;
    padding: 8px 12px;
    border-radius: 5px;
    font-size: 0.9rem;
    transition: all 0.2s ease;
    position: relative;
    border-left: 3px solid transparent;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.mega-menu-links a:hover {
    color: #E86A17;
    background: rgba(232, 106, 23, 0.05);
    border-left-color: #E86A17;
    transform: translateX(5px);
    text-decoration: none;
}

/* Arabic and Urdu text styling */
.mega-menu-title:contains('اردو'),
.mega-menu-title:contains('العربية') {
    text-align: right;
    font-family: 'Jameel Noori Nastaleeq', 'Amiri', 'Times New Roman', serif;
}

.mega-menu-links a[href*="language='urdu'"] {
    text-align: right;
    font-family: 'Jameel Noori Nastaleeq', 'Noto Nastaliq Urdu', serif;
    direction: rtl;
}

.mega-menu-links a[href*="language='arabic'"] {
    text-align: right;
    font-family: 'Amiri', 'Times New Roman', serif;
    direction: rtl;
}

/* Responsive adjustments */
@media (max-width: 1200px) {
    .header-nav-links {
        gap: 1.5rem;
    }
    
    .header-nav-link {
        font-size: 0.9rem;
        padding: 6px 10px;
    }
    
    .mega-menu-content {
        gap: 30px;
        padding: 30px 0;
    }
    
    .mega-menu-container {
        padding: 0 15px;
    }
}

@media (max-width: 992px) {
    .mega-menu-content {
        grid-template-columns: 1fr 1fr;
        gap: 25px;
    }
    
    .mega-menu-section:last-child {
        grid-column: 1 / -1;
    }
}

@media (max-width: 768px) {
    /* Show mobile buttons only when desktop nav is hidden */
    .mobile-menu-toggle {
        display: flex !important;
        padding: 15px 20px;
        border-bottom: 1px solid #dee2e6;
    }
    
    .mobile-search-bar {
        display: none !important;
    }
    
    .mobile-search-bar.show {
        display: block !important;
    }
    
    .mobile-menu-toggle .btn {
        font-weight: 500;
        padding: 8px 12px;
        border-radius: 5px;
        font-size: 0.85rem;
    }
    
    /* Menu button styling - Dark brown (primary brand) */
    .mobile-menu-toggle .btn-outline-primary {
        background-color: #3B2A22;
        border-color: #3B2A22;
        color: white;
    }
    
    .mobile-menu-toggle .btn-outline-primary:hover {
        background-color: #2C1F19;
        border-color: #2C1F19;
        color: white;
    }
    
    /* Search button styling - Elegant teal */
    .mobile-menu-toggle .btn-outline-info {
        background-color: #2C5F65;
        border-color: #2C5F65;
        color: white;
    }
    
    .mobile-menu-toggle .btn-outline-info:hover {
        background-color: #1F4A4F;
        border-color: #1F4A4F;
        color: white;
    }
    
    /* Phone button styling - Warm orange (brand secondary) */
    .mobile-menu-toggle .btn-outline-warning {
        background-color: #E86A17;
        border-color: #E86A17;
        color: white;
    }
    
    .mobile-menu-toggle .btn-outline-warning:hover {
        background-color: #D25A0E;
        border-color: #D25A0E;
        color: white;
    }
    
    /* WhatsApp button styling - Classic WhatsApp green */
    .mobile-menu-toggle .btn-success {
        background-color: #25D366;
        border-color: #25D366;
        color: white;
    }
    
    .mobile-menu-toggle .btn-success:hover {
        background-color: #20BA5A;
        border-color: #20BA5A;
        color: white;
    }
    
    /* Mobile search bar styling */
    .mobile-search-bar {
        background-color: #f8f9fa;
    }
    
    .mobile-search-bar .form-control {
        border-radius: 5px;
        font-size: 0.9rem;
    }
    
    /* Hide navigation by default on mobile */
    .header-nav-horizontal {
        display: none;
        padding: 0 !important;
    }
    
    /* Show navigation when active */
    .header-nav-horizontal.mobile-menu-active {
        display: block;
    }
    
    .header-nav-links {
        flex-direction: column;
        gap: 0 !important;
        align-items: stretch;
    }
    
    .header-nav-link, .header-nav-dropdown {
        width: 100%;
        border-bottom: 1px solid #f0f0f0;
    }
    
    .header-nav-link {
        padding: 15px 20px;
        display: block;
        color: #3B2A22;
        font-weight: 500;
        font-size: 1rem;
        transition: all 0.2s ease;
        white-space: normal;
    }
    
    .header-nav-link:hover {
        background-color: #f8f9fa;
        color: #E86A17;
        padding-left: 25px;
    }
    
    .header-nav-link i {
        width: 20px;
        text-align: center;
        margin-right: 12px;
    }
    
    /* Hide mega menus on mobile */
    .mega-menu {
        display: none !important;
    }
    
    /* Hide chevron arrows on mobile */
    .fa-chevron-down {
        display: none;
    }
    
    /* Ensure container takes full width */
    .desktop-header-nav .container {
        padding: 0;
        max-width: 100%;
    }
}

</style>

<script>
function toggleMobileMenu() {
    const nav = document.querySelector('.header-nav-horizontal');
    const button = document.querySelector('.mobile-menu-toggle .btn');
    const icon = button.querySelector('i');
    const searchBar = document.getElementById('mobileSearchBar');
    
    // Close search if open
    if (searchBar.classList.contains('show')) {
        searchBar.classList.remove('show');
    }
    
    if (nav.classList.contains('mobile-menu-active')) {
        nav.classList.remove('mobile-menu-active');
        icon.className = 'fas fa-bars me-2';
        button.innerHTML = '<i class="fas fa-bars me-2"></i>Menu';
    } else {
        nav.classList.add('mobile-menu-active');
        icon.className = 'fas fa-times me-2';
        button.innerHTML = '<i class="fas fa-times me-2"></i>Close';
    }
}

function toggleMobileSearch() {
    const searchBar = document.getElementById('mobileSearchBar');
    const nav = document.querySelector('.header-nav-horizontal');
    
    // Close menu if open
    if (nav.classList.contains('mobile-menu-active')) {
        nav.classList.remove('mobile-menu-active');
        const menuButton = document.querySelector('.mobile-menu-toggle .btn');
        menuButton.innerHTML = '<i class="fas fa-bars me-2"></i>Menu';
    }
    
    // Toggle search bar visibility
    if (searchBar.classList.contains('show')) {
        searchBar.classList.remove('show');
    } else {
        searchBar.classList.add('show');
        // Focus on input after a short delay to ensure it's visible
        setTimeout(() => {
            searchBar.querySelector('input').focus();
        }, 100);
    }
}
</script>

<!-- Language Selector (if multi-language support is needed) -->
{% if config.get('LANGUAGES') and config.LANGUAGES|length > 1 %}
<div class="language-selector bg-light border-bottom">
    <div class="container">
        <div class="py-1 text-end">
            <small class="text-muted me-2">Language:</small>
            {% for code, name in config.LANGUAGES.items() %}
                <a href="{{ url_for(request.endpoint, lang=code, **request.view_args) }}" 
                   class="text-decoration-none me-2 {{ 'fw-bold' if get_locale() == code else '' }}">
                    {{ name }}
                </a>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}
